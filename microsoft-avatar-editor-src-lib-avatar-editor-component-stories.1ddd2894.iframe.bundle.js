(self.webpackChunkangular_avatar_editors=self.webpackChunkangular_avatar_editors||[]).push([[318],{"./packages/microsoft-avatar-editor/src/lib/avatar-editor.component.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,default:()=>avatar_editor_component_stories});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var avatar_editor_componentngResource=__webpack_require__("./packages/microsoft-avatar-editor/src/lib/avatar-editor.component.scss?ngResource"),avatar_editor_componentngResource_default=__webpack_require__.n(avatar_editor_componentngResource),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs_interop=__webpack_require__("./node_modules/@angular/core/fesm2022/rxjs-interop.mjs"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js");let NgxAvatarEditorCanvasDirective=class NgxAvatarEditorCanvasDirective{constructor(){this.#destroyRef=(0,core.inject)(core.DestroyRef),this.#elementRef=(0,core.inject)(core.ElementRef),this.#injector=(0,core.inject)(core.Injector),this.#canvas=this.#elementRef.nativeElement,this.#context=this.#canvas.getContext("2d"),this.#image=(0,core.signal)(null),this.#translation=(0,core.signal)(new DOMPointReadOnly),this._initialScale=(0,core.computed)((()=>1/this._maximumScale())),this._maximumScale=(0,core.computed)((()=>{if(null==this.#image())return 0;const image=this.#image();return Math.min(image.naturalWidth/this.#canvas.offsetWidth,image.naturalHeight/this.#canvas.offsetHeight)})),this.#absoluteScale=(0,core.signal)(1)}#destroyRef;#elementRef;#injector;#canvas;#context;#image;#translation;#absoluteScale;get src(){return this.#src}set src(value){this.#src=value,this.#loadImage(this.#src)}#src;ngAfterViewInit(){(0,rxjs_interop.Dx)(this.#image,{injector:this.#injector}).pipe((0,rxjs_interop.sL)(this.#destroyRef),(0,filter.h)(Boolean)).subscribe((image=>this.#fitImage(image))),(0,core.effect)((()=>this.#draw(this.#translation())),{injector:this.#injector})}#loadImage(src){const image=new Image;image.onload=()=>{this.#image.set(image)},image.src=src}#fitImage(image){const{naturalWidth,naturalHeight}=image,{offsetWidth,offsetHeight}=this.#canvas;this.#canvas.width=offsetWidth,this.#canvas.height=offsetHeight;const x=(offsetWidth-naturalWidth*this._initialScale())/2,y=(offsetHeight-naturalHeight*this._initialScale())/2;this.#translation.set(new DOMPointReadOnly(x,y))}#draw(translation){if(null==this.#image())return;const image=this.#image(),{naturalWidth,naturalHeight}=image,{offsetWidth,offsetHeight}=this.#canvas;this.#context.fillRect(0,0,offsetWidth,offsetHeight),this.#context.save(),this.#context.translate(offsetWidth/2,offsetHeight/2),this.#context.transform(1,0,0,1,0,0),this.#context.translate(-1*offsetWidth/2,-1*offsetHeight/2),this.#context?.restore(),this.#context.drawImage(image,translation.x,translation.y,naturalWidth*this.#absoluteScale()/this._maximumScale(),naturalHeight*this.#absoluteScale()/this._maximumScale())}static#_=this.propDecorators={src:[{type:core.Input,args:[{required:!0}]}]}};NgxAvatarEditorCanvasDirective=(0,tslib_es6.gn)([(0,core.Directive)({selector:"canvas[ngxAvatarEditorCanvas]",standalone:!0})],NgxAvatarEditorCanvasDirective);let NgxAvatarEditorComponent=class NgxAvatarEditorComponent{static#_=this.propDecorators={src:[{type:core.Input,args:[{required:!0}]}]}};NgxAvatarEditorComponent=(0,tslib_es6.gn)([(0,core.Component)({selector:"ngx-avatar-editor",standalone:!0,imports:[common.CommonModule,NgxAvatarEditorCanvasDirective],template:'<canvas ngxAvatarEditorCanvas [src]="src"></canvas>\n<div id="shade"></div>\n',encapsulation:core.ViewEncapsulation.ShadowDom,changeDetection:core.ChangeDetectionStrategy.OnPush,styles:[avatar_editor_componentngResource_default()]})],NgxAvatarEditorComponent);const avatar_editor_component_stories={component:NgxAvatarEditorComponent,title:"Components/MicrosoftAvatarEditor",parameters:{layout:"centered"}},Primary={args:{src:"grace-hilty-uvAhJHLul_Q-unsplash.jpg"}}},"./packages/microsoft-avatar-editor/src/lib/avatar-editor.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  display: block;\n  position: relative;\n  box-sizing: border-box;\n  outline: 0;\n  overflow: hidden;\n  width: 256px;\n  height: 600px;\n}\n\ncanvas[ngxAvatarEditorCanvas] {\n  width: 256px;\n  height: 256px;\n}\n\n#shade {\n  box-sizing: border-box;\n  position: absolute;\n  inset: 0;\n  max-height: 256px;\n  border-radius: 50%;\n  border: 2px solid rgba(255, 255, 255, 0.7);\n  outline: max(100vw, 100vh) solid rgba(255, 255, 255, 0.4);\n  pointer-events: none;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()}}]);